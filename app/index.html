<html>

<head>
    <title>BlockCities</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet"
          href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
          crossorigin="anonymous">
</head>

<body>

<div id="vue-app" class="container-fluid">
    <div class="jumbotron mt-5">
        <h1 class="display-4">BlockCities Vending Machine</h1>
        <p class="lead">Be the Architect</p>
        <hr class="my-4">
        <div class="row">
            <div class="col">
                <p class="lead">
                    Price per building: {{ pricePerBuildingInWei }} WEI<br/>
                    <a class="btn btn-primary btn-lg" href="#" role="button" @click="mintBuilding()">Mint building</a>
                </p>
            </div>
            <div class="col">
                <p class="lead">
                    Total buildings: {{ totalBuildings }}
                </p>
            </div>
        </div>
        <div class="row" v-if="buildingMetaData">
            <div class="col">
                <code>
                    {{ buildingMetaData }}
                </code>
            </div>
            <div class="col text-center">
                <img :src="buildingMetaData.image" class="img-fluid" style="max-height: 300px"/>
            </div>
        </div>
    </div>

    <div class="card-columns" v-if="buildings">
        <div class="card m-2 p-2" v-for="b in buildings">
            <img class="card-img-top" :src="b.data.image" :alt="b.data.name" style="max-height: 250px">
            <div class="card-body">
                <h3 class="card-title text-center">{{ b.data.name }}</h3>
                <h3 class="text-center">{{ lookupCityName(b.data.city) }}</h3>
                <p class="small">
                    <span class="text-muted">City</span> <code>{{ b.data.attributes.city }}</code><br/>
                    <span class="text-muted">Building</span> <code>{{ b.data.attributes.building }}</code><br/>
                    <span class="text-muted">Base</span> <code>{{ b.data.attributes.base }}</code><br/>
                    <span class="text-muted">Body</span> <code>{{ b.data.attributes.body }}</code><br/>
                    <span class="text-muted">Roof</span> <code>{{ b.data.attributes.roof }}</code><br/>
                    <span class="text-muted">Exterior</span> <code>{{ b.data.attributes.exteriorColorway }}</code><br/>
                    <span class="text-muted">Background</span> <code>{{ b.data.attributes.backgroundColorway }}</code>
                </p>
                <p class="small"><span class="text-muted">Architect</span> <code>{{ b.data.attributes.architect }}</code></p>
            </div>
        </div>
    </div>
</div>

<script src="https://use.fontawesome.com/e88a1894a6.js" type="text/javascript"></script>

<!-- This exposes the library as a global variable: ethers -->
<script src="https://cdn.ethers.io/scripts/ethers-v4.min.js"
        charset="utf-8"
        type="text/javascript">
</script>

<script src="https://unpkg.com/vue/dist/vue.js" type="text/javascript"></script>
<script src="https://unpkg.com/vue-toasted"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>


<script>
    /* global Vue, ethers, Toasted, axios */
    Vue.use(Toasted);

    // var provider = new ethers.providers.InfuraProvider('ropsten');
    // const provider = new ethers.providers.JsonRpcProvider('http://127.0.0.1:7545');
    const provider = new ethers.providers.Web3Provider(web3.currentProvider);
    const signer = provider.getSigner();
    const networkId = 5777;

    new Vue({
        el: '#vue-app',
        data: {
            rootApi: (networkId === 5777) ? `http://localhost:5000/block-cities/us-central1/api` : `https://us-central1-block-cities.cloudfunctions.net/api`,
            blockcitiesAddress: `0xa29CC34Fe8C6333f31a1C9e18960D4bA8fD8b8D9`,
            blockcitiesAbi: [
                {
                    "constant": true,
                    "inputs": [
                        {
                            "name": "interfaceId",
                            "type": "bytes4"
                        }
                    ],
                    "name": "supportsInterface",
                    "outputs": [
                        {
                            "name": "",
                            "type": "bool"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function",
                    "signature": "0x01ffc9a7"
                },
                {
                    "constant": true,
                    "inputs": [],
                    "name": "name",
                    "outputs": [
                        {
                            "name": "",
                            "type": "string"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function",
                    "signature": "0x06fdde03"
                },
                {
                    "constant": true,
                    "inputs": [
                        {
                            "name": "tokenId",
                            "type": "uint256"
                        }
                    ],
                    "name": "getApproved",
                    "outputs": [
                        {
                            "name": "",
                            "type": "address"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function",
                    "signature": "0x081812fc"
                },
                {
                    "constant": false,
                    "inputs": [
                        {
                            "name": "to",
                            "type": "address"
                        },
                        {
                            "name": "tokenId",
                            "type": "uint256"
                        }
                    ],
                    "name": "approve",
                    "outputs": [],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "function",
                    "signature": "0x095ea7b3"
                },
                {
                    "constant": false,
                    "inputs": [
                        {
                            "name": "account",
                            "type": "address"
                        }
                    ],
                    "name": "addWhitelisted",
                    "outputs": [],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "function",
                    "signature": "0x10154bad"
                },
                {
                    "constant": true,
                    "inputs": [],
                    "name": "totalSupply",
                    "outputs": [
                        {
                            "name": "",
                            "type": "uint256"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function",
                    "signature": "0x18160ddd"
                },
                {
                    "constant": false,
                    "inputs": [
                        {
                            "name": "from",
                            "type": "address"
                        },
                        {
                            "name": "to",
                            "type": "address"
                        },
                        {
                            "name": "tokenId",
                            "type": "uint256"
                        }
                    ],
                    "name": "transferFrom",
                    "outputs": [],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "function",
                    "signature": "0x23b872dd"
                },
                {
                    "constant": false,
                    "inputs": [
                        {
                            "name": "account",
                            "type": "address"
                        }
                    ],
                    "name": "removeWhitelisted",
                    "outputs": [],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "function",
                    "signature": "0x291d9549"
                },
                {
                    "constant": true,
                    "inputs": [
                        {
                            "name": "owner",
                            "type": "address"
                        },
                        {
                            "name": "index",
                            "type": "uint256"
                        }
                    ],
                    "name": "tokenOfOwnerByIndex",
                    "outputs": [
                        {
                            "name": "",
                            "type": "uint256"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function",
                    "signature": "0x2f745c59"
                },
                {
                    "constant": true,
                    "inputs": [
                        {
                            "name": "account",
                            "type": "address"
                        }
                    ],
                    "name": "isWhitelisted",
                    "outputs": [
                        {
                            "name": "",
                            "type": "bool"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function",
                    "signature": "0x3af32abf"
                },
                {
                    "constant": true,
                    "inputs": [],
                    "name": "tokenIdPointer",
                    "outputs": [
                        {
                            "name": "",
                            "type": "uint256"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function",
                    "signature": "0x3b3a1a7a"
                },
                {
                    "constant": true,
                    "inputs": [],
                    "name": "totalBuildings",
                    "outputs": [
                        {
                            "name": "",
                            "type": "uint256"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function",
                    "signature": "0x3ba5c722"
                },
                {
                    "constant": false,
                    "inputs": [
                        {
                            "name": "from",
                            "type": "address"
                        },
                        {
                            "name": "to",
                            "type": "address"
                        },
                        {
                            "name": "tokenId",
                            "type": "uint256"
                        }
                    ],
                    "name": "safeTransferFrom",
                    "outputs": [],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "function",
                    "signature": "0x42842e0e"
                },
                {
                    "constant": false,
                    "inputs": [],
                    "name": "renounceWhitelistAdmin",
                    "outputs": [],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "function",
                    "signature": "0x4c5a628c"
                },
                {
                    "constant": true,
                    "inputs": [],
                    "name": "tokenBaseURI",
                    "outputs": [
                        {
                            "name": "",
                            "type": "string"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function",
                    "signature": "0x4e99b800"
                },
                {
                    "constant": true,
                    "inputs": [
                        {
                            "name": "index",
                            "type": "uint256"
                        }
                    ],
                    "name": "tokenByIndex",
                    "outputs": [
                        {
                            "name": "",
                            "type": "uint256"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function",
                    "signature": "0x4f6ccce7"
                },
                {
                    "constant": true,
                    "inputs": [
                        {
                            "name": "tokenId",
                            "type": "uint256"
                        }
                    ],
                    "name": "ownerOf",
                    "outputs": [
                        {
                            "name": "",
                            "type": "address"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function",
                    "signature": "0x6352211e"
                },
                {
                    "constant": true,
                    "inputs": [
                        {
                            "name": "owner",
                            "type": "address"
                        }
                    ],
                    "name": "balanceOf",
                    "outputs": [
                        {
                            "name": "",
                            "type": "uint256"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function",
                    "signature": "0x70a08231"
                },
                {
                    "constant": false,
                    "inputs": [
                        {
                            "name": "account",
                            "type": "address"
                        }
                    ],
                    "name": "addWhitelistAdmin",
                    "outputs": [],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "function",
                    "signature": "0x7362d9c8"
                },
                {
                    "constant": true,
                    "inputs": [],
                    "name": "symbol",
                    "outputs": [
                        {
                            "name": "",
                            "type": "string"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function",
                    "signature": "0x95d89b41"
                },
                {
                    "constant": false,
                    "inputs": [
                        {
                            "name": "to",
                            "type": "address"
                        },
                        {
                            "name": "approved",
                            "type": "bool"
                        }
                    ],
                    "name": "setApprovalForAll",
                    "outputs": [],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "function",
                    "signature": "0xa22cb465"
                },
                {
                    "constant": false,
                    "inputs": [
                        {
                            "name": "from",
                            "type": "address"
                        },
                        {
                            "name": "to",
                            "type": "address"
                        },
                        {
                            "name": "tokenId",
                            "type": "uint256"
                        },
                        {
                            "name": "_data",
                            "type": "bytes"
                        }
                    ],
                    "name": "safeTransferFrom",
                    "outputs": [],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "function",
                    "signature": "0xb88d4fde"
                },
                {
                    "constant": true,
                    "inputs": [
                        {
                            "name": "account",
                            "type": "address"
                        }
                    ],
                    "name": "isWhitelistAdmin",
                    "outputs": [
                        {
                            "name": "",
                            "type": "bool"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function",
                    "signature": "0xbb5f747b"
                },
                {
                    "constant": false,
                    "inputs": [],
                    "name": "renounceWhitelisted",
                    "outputs": [],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "function",
                    "signature": "0xd6cd9473"
                },
                {
                    "constant": true,
                    "inputs": [
                        {
                            "name": "owner",
                            "type": "address"
                        },
                        {
                            "name": "operator",
                            "type": "address"
                        }
                    ],
                    "name": "isApprovedForAll",
                    "outputs": [
                        {
                            "name": "",
                            "type": "bool"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function",
                    "signature": "0xe985e9c5"
                },
                {
                    "inputs": [
                        {
                            "name": "_tokenBaseURI",
                            "type": "string"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "constructor",
                    "signature": "constructor"
                },
                {
                    "anonymous": false,
                    "inputs": [
                        {
                            "indexed": true,
                            "name": "_tokenId",
                            "type": "uint256"
                        },
                        {
                            "indexed": true,
                            "name": "_to",
                            "type": "address"
                        },
                        {
                            "indexed": true,
                            "name": "_architect",
                            "type": "address"
                        }
                    ],
                    "name": "BuildingMinted",
                    "type": "event",
                    "signature": "0x90ac329ea07c00bb85a3b33470a0318e5d1a5e181fd50431248bc3c750695277"
                },
                {
                    "anonymous": false,
                    "inputs": [
                        {
                            "indexed": true,
                            "name": "account",
                            "type": "address"
                        }
                    ],
                    "name": "WhitelistedAdded",
                    "type": "event",
                    "signature": "0xee1504a83b6d4a361f4c1dc78ab59bfa30d6a3b6612c403e86bb01ef2984295f"
                },
                {
                    "anonymous": false,
                    "inputs": [
                        {
                            "indexed": true,
                            "name": "account",
                            "type": "address"
                        }
                    ],
                    "name": "WhitelistedRemoved",
                    "type": "event",
                    "signature": "0x270d9b30cf5b0793bbfd54c9d5b94aeb49462b8148399000265144a8722da6b6"
                },
                {
                    "anonymous": false,
                    "inputs": [
                        {
                            "indexed": true,
                            "name": "account",
                            "type": "address"
                        }
                    ],
                    "name": "WhitelistAdminAdded",
                    "type": "event",
                    "signature": "0x22380c05984257a1cb900161c713dd71d39e74820f1aea43bd3f1bdd20961299"
                },
                {
                    "anonymous": false,
                    "inputs": [
                        {
                            "indexed": true,
                            "name": "account",
                            "type": "address"
                        }
                    ],
                    "name": "WhitelistAdminRemoved",
                    "type": "event",
                    "signature": "0x0a8eb35e5ca14b3d6f28e4abf2f128dbab231a58b56e89beb5d636115001e165"
                },
                {
                    "anonymous": false,
                    "inputs": [
                        {
                            "indexed": true,
                            "name": "from",
                            "type": "address"
                        },
                        {
                            "indexed": true,
                            "name": "to",
                            "type": "address"
                        },
                        {
                            "indexed": true,
                            "name": "tokenId",
                            "type": "uint256"
                        }
                    ],
                    "name": "Transfer",
                    "type": "event",
                    "signature": "0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"
                },
                {
                    "anonymous": false,
                    "inputs": [
                        {
                            "indexed": true,
                            "name": "owner",
                            "type": "address"
                        },
                        {
                            "indexed": true,
                            "name": "approved",
                            "type": "address"
                        },
                        {
                            "indexed": true,
                            "name": "tokenId",
                            "type": "uint256"
                        }
                    ],
                    "name": "Approval",
                    "type": "event",
                    "signature": "0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925"
                },
                {
                    "anonymous": false,
                    "inputs": [
                        {
                            "indexed": true,
                            "name": "owner",
                            "type": "address"
                        },
                        {
                            "indexed": true,
                            "name": "operator",
                            "type": "address"
                        },
                        {
                            "indexed": false,
                            "name": "approved",
                            "type": "bool"
                        }
                    ],
                    "name": "ApprovalForAll",
                    "type": "event",
                    "signature": "0x17307eab39ab6107e8899845ad3d59bd9653f200f220920489ca2b5937696c31"
                },
                {
                    "constant": false,
                    "inputs": [
                        {
                            "name": "_exteriorColorway",
                            "type": "uint256"
                        },
                        {
                            "name": "_backgroundColorway",
                            "type": "uint256"
                        },
                        {
                            "name": "_city",
                            "type": "uint256"
                        },
                        {
                            "name": "_building",
                            "type": "uint256"
                        },
                        {
                            "name": "_base",
                            "type": "uint256"
                        },
                        {
                            "name": "_body",
                            "type": "uint256"
                        },
                        {
                            "name": "_roof",
                            "type": "uint256"
                        },
                        {
                            "name": "_special",
                            "type": "uint256"
                        },
                        {
                            "name": "_architect",
                            "type": "address"
                        }
                    ],
                    "name": "createBuilding",
                    "outputs": [
                        {
                            "name": "_tokenId",
                            "type": "uint256"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "function",
                    "signature": "0x90708008"
                },
                {
                    "constant": true,
                    "inputs": [
                        {
                            "name": "tokenId",
                            "type": "uint256"
                        }
                    ],
                    "name": "tokenURI",
                    "outputs": [
                        {
                            "name": "",
                            "type": "string"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function",
                    "signature": "0xc87b56dd"
                },
                {
                    "constant": true,
                    "inputs": [
                        {
                            "name": "_tokenId",
                            "type": "uint256"
                        }
                    ],
                    "name": "attributes",
                    "outputs": [
                        {
                            "name": "_exteriorColorway",
                            "type": "uint256"
                        },
                        {
                            "name": "_backgroundColorway",
                            "type": "uint256"
                        },
                        {
                            "name": "_city",
                            "type": "uint256"
                        },
                        {
                            "name": "_building",
                            "type": "uint256"
                        },
                        {
                            "name": "_base",
                            "type": "uint256"
                        },
                        {
                            "name": "_body",
                            "type": "uint256"
                        },
                        {
                            "name": "_roof",
                            "type": "uint256"
                        },
                        {
                            "name": "_special",
                            "type": "uint256"
                        },
                        {
                            "name": "_architect",
                            "type": "address"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function",
                    "signature": "0xd05dcc6a"
                },
                {
                    "constant": true,
                    "inputs": [
                        {
                            "name": "owner",
                            "type": "address"
                        }
                    ],
                    "name": "tokensOfOwner",
                    "outputs": [
                        {
                            "name": "",
                            "type": "uint256[]"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function",
                    "signature": "0x8462151c"
                },
                {
                    "constant": false,
                    "inputs": [
                        {
                            "name": "_tokenId",
                            "type": "uint256"
                        }
                    ],
                    "name": "burn",
                    "outputs": [
                        {
                            "name": "",
                            "type": "bool"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "function",
                    "signature": "0x42966c68"
                },
                {
                    "constant": false,
                    "inputs": [
                        {
                            "name": "_newBaseURI",
                            "type": "string"
                        }
                    ],
                    "name": "updateTokenBaseURI",
                    "outputs": [],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "function",
                    "signature": "0x2295ee5b"
                }
            ],
            blockcitiesContract: null,
            vendingAddress: `0x5BbA833e33103d60f716fDCA8ac947920F909eF3`,
            vendingAbi: [
                {
                    "constant": true,
                    "inputs": [],
                    "name": "floorPricePerBuildingInWei",
                    "outputs": [
                        {
                            "name": "",
                            "type": "uint256"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function",
                    "signature": "0x0113ddea"
                },
                {
                    "constant": true,
                    "inputs": [],
                    "name": "blockcities",
                    "outputs": [
                        {
                            "name": "",
                            "type": "address"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function",
                    "signature": "0x068cc81e"
                },
                {
                    "constant": true,
                    "inputs": [],
                    "name": "blockCities",
                    "outputs": [
                        {
                            "name": "",
                            "type": "address"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function",
                    "signature": "0x0bd3b6fd"
                },
                {
                    "constant": true,
                    "inputs": [],
                    "name": "lastSaleBlock",
                    "outputs": [
                        {
                            "name": "",
                            "type": "uint256"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function",
                    "signature": "0x19a266ca"
                },
                {
                    "constant": true,
                    "inputs": [],
                    "name": "colourGenerator",
                    "outputs": [
                        {
                            "name": "",
                            "type": "address"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function",
                    "signature": "0x42b9d5e0"
                },
                {
                    "constant": false,
                    "inputs": [
                        {
                            "name": "_partner",
                            "type": "address"
                        }
                    ],
                    "name": "updatePartnerAddress",
                    "outputs": [],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "function",
                    "signature": "0x44a71fbb"
                },
                {
                    "constant": true,
                    "inputs": [],
                    "name": "totalPurchasesInWei",
                    "outputs": [
                        {
                            "name": "",
                            "type": "uint256"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function",
                    "signature": "0x5f1e98c7"
                },
                {
                    "constant": false,
                    "inputs": [
                        {
                            "name": "_techPartnerRate",
                            "type": "uint256"
                        }
                    ],
                    "name": "updatePartnerRate",
                    "outputs": [],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "function",
                    "signature": "0x69aa9b25"
                },
                {
                    "constant": false,
                    "inputs": [],
                    "name": "renounceOwnership",
                    "outputs": [],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "function",
                    "signature": "0x715018a6"
                },
                {
                    "constant": true,
                    "inputs": [],
                    "name": "logicGenerator",
                    "outputs": [
                        {
                            "name": "",
                            "type": "address"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function",
                    "signature": "0x73fbae5a"
                },
                {
                    "constant": true,
                    "inputs": [],
                    "name": "owner",
                    "outputs": [
                        {
                            "name": "",
                            "type": "address"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function",
                    "signature": "0x8da5cb5b"
                },
                {
                    "constant": true,
                    "inputs": [],
                    "name": "isOwner",
                    "outputs": [
                        {
                            "name": "",
                            "type": "bool"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function",
                    "signature": "0x8f32d59b"
                },
                {
                    "constant": false,
                    "inputs": [
                        {
                            "name": "_blockcities",
                            "type": "address"
                        }
                    ],
                    "name": "updateBlockcitiesAddress",
                    "outputs": [],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "function",
                    "signature": "0x93f27be9"
                },
                {
                    "constant": true,
                    "inputs": [],
                    "name": "partnerRate",
                    "outputs": [
                        {
                            "name": "",
                            "type": "uint256"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function",
                    "signature": "0xb7be867e"
                },
                {
                    "constant": true,
                    "inputs": [],
                    "name": "priceStepInWei",
                    "outputs": [
                        {
                            "name": "",
                            "type": "uint256"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function",
                    "signature": "0xbddd7655"
                },
                {
                    "constant": true,
                    "inputs": [],
                    "name": "partner",
                    "outputs": [
                        {
                            "name": "",
                            "type": "address"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function",
                    "signature": "0xbe10862b"
                },
                {
                    "constant": true,
                    "inputs": [],
                    "name": "blockStep",
                    "outputs": [
                        {
                            "name": "",
                            "type": "uint256"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function",
                    "signature": "0xcc11c383"
                },
                {
                    "constant": true,
                    "inputs": [
                        {
                            "name": "",
                            "type": "uint256"
                        }
                    ],
                    "name": "priceDiscountBands",
                    "outputs": [
                        {
                            "name": "",
                            "type": "uint256"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function",
                    "signature": "0xcc9a062f"
                },
                {
                    "constant": true,
                    "inputs": [],
                    "name": "ceilingPricePerBuildingInWei",
                    "outputs": [
                        {
                            "name": "",
                            "type": "uint256"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function",
                    "signature": "0xd9689eeb"
                },
                {
                    "constant": false,
                    "inputs": [
                        {
                            "name": "newOwner",
                            "type": "address"
                        }
                    ],
                    "name": "transferOwnership",
                    "outputs": [],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "function",
                    "signature": "0xf2fde38b"
                },
                {
                    "constant": true,
                    "inputs": [
                        {
                            "name": "",
                            "type": "address"
                        }
                    ],
                    "name": "credits",
                    "outputs": [
                        {
                            "name": "",
                            "type": "uint256"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function",
                    "signature": "0xfe5ff468"
                },
                {
                    "inputs": [
                        {
                            "name": "_logicGenerator",
                            "type": "address"
                        },
                        {
                            "name": "_colourGenerator",
                            "type": "address"
                        },
                        {
                            "name": "_blockCities",
                            "type": "address"
                        },
                        {
                            "name": "_blockCitiesAddress",
                            "type": "address"
                        },
                        {
                            "name": "_partnerAddress",
                            "type": "address"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "constructor",
                    "signature": "constructor"
                },
                {
                    "anonymous": false,
                    "inputs": [
                        {
                            "indexed": true,
                            "name": "_tokenId",
                            "type": "uint256"
                        },
                        {
                            "indexed": true,
                            "name": "_architect",
                            "type": "address"
                        }
                    ],
                    "name": "VendingMachineTriggered",
                    "type": "event",
                    "signature": "0x372a2d4d08206e1dfd3c166a68a3079282f2d28d305b51a31446b04522032538"
                },
                {
                    "anonymous": false,
                    "inputs": [
                        {
                            "indexed": true,
                            "name": "_to",
                            "type": "address"
                        },
                        {
                            "indexed": false,
                            "name": "_amount",
                            "type": "uint256"
                        }
                    ],
                    "name": "CreditAdded",
                    "type": "event",
                    "signature": "0x648ec643b30463f72debf7027a0f9ff84bbdf4dc1a2a7ab973cb77dec5326568"
                },
                {
                    "anonymous": false,
                    "inputs": [
                        {
                            "indexed": false,
                            "name": "_priceDiscountBands",
                            "type": "uint256[2]"
                        }
                    ],
                    "name": "PriceDiscountBandsChanged",
                    "type": "event",
                    "signature": "0x3f6f57f4c984d98b526cc964d520ad73f29807ad468896e02c113d4b61725fca"
                },
                {
                    "anonymous": false,
                    "inputs": [
                        {
                            "indexed": false,
                            "name": "_oldPriceStepInWei",
                            "type": "uint256"
                        },
                        {
                            "indexed": false,
                            "name": "_newPriceStepInWei",
                            "type": "uint256"
                        }
                    ],
                    "name": "PriceStepInWeiChanged",
                    "type": "event",
                    "signature": "0x37a3e83e0286b341a68ba76633b42dbb0a4a82fc4022b52a8d68fdda7a70004e"
                },
                {
                    "anonymous": false,
                    "inputs": [
                        {
                            "indexed": false,
                            "name": "_oldPricePerBuildingInWei",
                            "type": "uint256"
                        },
                        {
                            "indexed": false,
                            "name": "_newPricePerBuildingInWei",
                            "type": "uint256"
                        }
                    ],
                    "name": "PricePerBuildingInWeiChanged",
                    "type": "event",
                    "signature": "0x6eb4d51aa48070ba41a35eb953c66c728b4c501b8f861193e18c39999f0e1213"
                },
                {
                    "anonymous": false,
                    "inputs": [
                        {
                            "indexed": false,
                            "name": "_oldFloorPricePerBuildingInWei",
                            "type": "uint256"
                        },
                        {
                            "indexed": false,
                            "name": "_newFloorPricePerBuildingInWei",
                            "type": "uint256"
                        }
                    ],
                    "name": "FloorPricePerBuildingInWeiChanged",
                    "type": "event",
                    "signature": "0x38ee7c735d6320ca1146e0d0f3f487300bc2ae465f66d6d7d8bc8ae3f47f1759"
                },
                {
                    "anonymous": false,
                    "inputs": [
                        {
                            "indexed": false,
                            "name": "_oldCeilingPricePerBuildingInWei",
                            "type": "uint256"
                        },
                        {
                            "indexed": false,
                            "name": "_newCeilingPricePerBuildingInWei",
                            "type": "uint256"
                        }
                    ],
                    "name": "CeilingPricePerBuildingInWeiChanged",
                    "type": "event",
                    "signature": "0xe880581dd641cadbdef0f2e2356247b0c6a7dd93bb4a71729a50698f09a044a4"
                },
                {
                    "anonymous": false,
                    "inputs": [
                        {
                            "indexed": false,
                            "name": "_oldBlockStep",
                            "type": "uint256"
                        },
                        {
                            "indexed": false,
                            "name": "_newBlockStep",
                            "type": "uint256"
                        }
                    ],
                    "name": "BlockStepChanged",
                    "type": "event",
                    "signature": "0x373c614e2ae93ee4d5971274986bdb8d7ce56aa7d251d6732e841fddb3c7ff84"
                },
                {
                    "anonymous": false,
                    "inputs": [
                        {
                            "indexed": false,
                            "name": "_oldLastSaleBlock",
                            "type": "uint256"
                        },
                        {
                            "indexed": false,
                            "name": "_newLastSaleBlock",
                            "type": "uint256"
                        }
                    ],
                    "name": "LastSaleBlockChanged",
                    "type": "event",
                    "signature": "0x86270eaaec3b663b71c4b521c94db85667cc0b17e0a595fe7d0b2e2a423b2047"
                },
                {
                    "anonymous": false,
                    "inputs": [
                        {
                            "indexed": true,
                            "name": "previousOwner",
                            "type": "address"
                        },
                        {
                            "indexed": true,
                            "name": "newOwner",
                            "type": "address"
                        }
                    ],
                    "name": "OwnershipTransferred",
                    "type": "event",
                    "signature": "0x8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e0"
                },
                {
                    "constant": false,
                    "inputs": [],
                    "name": "mintBuilding",
                    "outputs": [
                        {
                            "name": "_tokenId",
                            "type": "uint256"
                        }
                    ],
                    "payable": true,
                    "stateMutability": "payable",
                    "type": "function",
                    "signature": "0x6070e053"
                },
                {
                    "constant": false,
                    "inputs": [
                        {
                            "name": "_to",
                            "type": "address"
                        }
                    ],
                    "name": "mintBuildingTo",
                    "outputs": [
                        {
                            "name": "_tokenId",
                            "type": "uint256"
                        }
                    ],
                    "payable": true,
                    "stateMutability": "payable",
                    "type": "function",
                    "signature": "0x6ff3117f"
                },
                {
                    "constant": false,
                    "inputs": [
                        {
                            "name": "_numberOfBuildings",
                            "type": "uint256"
                        }
                    ],
                    "name": "mintBatch",
                    "outputs": [
                        {
                            "name": "_tokenIds",
                            "type": "uint256[]"
                        }
                    ],
                    "payable": true,
                    "stateMutability": "payable",
                    "type": "function",
                    "signature": "0x20e409b4"
                },
                {
                    "constant": false,
                    "inputs": [
                        {
                            "name": "_to",
                            "type": "address"
                        },
                        {
                            "name": "_numberOfBuildings",
                            "type": "uint256"
                        }
                    ],
                    "name": "mintBatchTo",
                    "outputs": [
                        {
                            "name": "_tokenIds",
                            "type": "uint256[]"
                        }
                    ],
                    "payable": true,
                    "stateMutability": "payable",
                    "type": "function",
                    "signature": "0xd52da3ae"
                },
                {
                    "constant": true,
                    "inputs": [
                        {
                            "name": "_numberOfBuildings",
                            "type": "uint256"
                        }
                    ],
                    "name": "totalPrice",
                    "outputs": [
                        {
                            "name": "",
                            "type": "uint256"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function",
                    "signature": "0x221f2285"
                },
                {
                    "constant": false,
                    "inputs": [
                        {
                            "name": "_pricePerBuildingInWei",
                            "type": "uint256"
                        }
                    ],
                    "name": "setPricePerBuildingInWei",
                    "outputs": [
                        {
                            "name": "",
                            "type": "bool"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "function",
                    "signature": "0x9fc1185e"
                },
                {
                    "constant": false,
                    "inputs": [
                        {
                            "name": "_priceStepInWei",
                            "type": "uint256"
                        }
                    ],
                    "name": "setPriceStepInWei",
                    "outputs": [
                        {
                            "name": "",
                            "type": "bool"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "function",
                    "signature": "0xc4844a87"
                },
                {
                    "constant": false,
                    "inputs": [
                        {
                            "name": "_newPriceDiscountBands",
                            "type": "uint256[2]"
                        }
                    ],
                    "name": "setPriceDiscountBands",
                    "outputs": [
                        {
                            "name": "",
                            "type": "bool"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "function",
                    "signature": "0x942bfa6e"
                },
                {
                    "constant": false,
                    "inputs": [
                        {
                            "name": "_to",
                            "type": "address"
                        }
                    ],
                    "name": "addCredit",
                    "outputs": [
                        {
                            "name": "",
                            "type": "bool"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "function",
                    "signature": "0x7c334d0b"
                },
                {
                    "constant": false,
                    "inputs": [
                        {
                            "name": "_to",
                            "type": "address"
                        },
                        {
                            "name": "_amount",
                            "type": "uint256"
                        }
                    ],
                    "name": "addCreditAmount",
                    "outputs": [
                        {
                            "name": "",
                            "type": "bool"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "function",
                    "signature": "0x51b6bdb5"
                },
                {
                    "constant": false,
                    "inputs": [
                        {
                            "name": "_addresses",
                            "type": "address[]"
                        },
                        {
                            "name": "_amount",
                            "type": "uint256"
                        }
                    ],
                    "name": "addCreditBatch",
                    "outputs": [
                        {
                            "name": "",
                            "type": "bool"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "function",
                    "signature": "0x6dd7bb4d"
                },
                {
                    "constant": false,
                    "inputs": [
                        {
                            "name": "_floorPricePerBuildingInWei",
                            "type": "uint256"
                        }
                    ],
                    "name": "setFloorPricePerBuildingInWei",
                    "outputs": [
                        {
                            "name": "",
                            "type": "bool"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "function",
                    "signature": "0x722e9272"
                },
                {
                    "constant": false,
                    "inputs": [
                        {
                            "name": "_ceilingPricePerBuildingInWei",
                            "type": "uint256"
                        }
                    ],
                    "name": "setCeilingPricePerBuildingInWei",
                    "outputs": [
                        {
                            "name": "",
                            "type": "bool"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "function",
                    "signature": "0x3249c527"
                },
                {
                    "constant": false,
                    "inputs": [
                        {
                            "name": "_blockStep",
                            "type": "uint256"
                        }
                    ],
                    "name": "setBlockStep",
                    "outputs": [
                        {
                            "name": "",
                            "type": "bool"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "function",
                    "signature": "0x71b8021a"
                },
                {
                    "constant": false,
                    "inputs": [
                        {
                            "name": "_lastSaleBlock",
                            "type": "uint256"
                        }
                    ],
                    "name": "setLastSaleBlock",
                    "outputs": [
                        {
                            "name": "",
                            "type": "bool"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "function",
                    "signature": "0xad4a6e76"
                },
                {
                    "constant": false,
                    "inputs": [
                        {
                            "name": "_logicGenerator",
                            "type": "address"
                        }
                    ],
                    "name": "setLogicGenerator",
                    "outputs": [
                        {
                            "name": "",
                            "type": "bool"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "function",
                    "signature": "0x8972ec6f"
                },
                {
                    "constant": false,
                    "inputs": [
                        {
                            "name": "_colourGenerator",
                            "type": "address"
                        }
                    ],
                    "name": "setColourGenerator",
                    "outputs": [
                        {
                            "name": "",
                            "type": "bool"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "function",
                    "signature": "0x624ab8be"
                }
            ],
            vendingContract: null,
            pricePerBuildingInWei: null,
            totalBuildings: 0,
            buildingTokenId: null,
            buildingMetaData: null,
            buildings: [],
        },
        methods: {
            lookupCityName: (id) => {
                if (parseInt(id) === 0) return 'ATL';
                if (parseInt(id) === 1) return 'NYC';
                if (parseInt(id) === 2) return 'CHI';
            },
            mintBuilding: async function () {

                this.pricePerBuildingInWei = (await this.vendingContract.totalPrice(1));

                let overrides = {

                    // The maximum units of gas for the transaction to use
                    gasLimit: 6721975,

                    // The price (in wei) per unit of gas
                    gasPrice: 1000000000,

                    // The amount to send with the transaction (i.e. msg.value)
                    value: this.pricePerBuildingInWei,
                };

                // wait for tx to be mined
                let tx = await this.vendingContract.mintBuilding(overrides);
                let receipt = await tx.wait(1);
                const tokenIdBN = receipt.events.pop().args[0];
                this.buildingTokenId = tokenIdBN.toNumber();
                console.log(`Token ID:`, this.buildingTokenId);

                this.$toasted.show(`Building created: ${this.buildingTokenId}`, {
                    theme: 'bubble',
                    position: 'bottom-center',
                    duration: 5000
                });

                // refresh total
                this.totalBuildings = (await this.blockcitiesContract.totalBuildings()).toNumber();

                let resp = await axios.get(`${this.rootApi}/network/${networkId}/token/${this.buildingTokenId}`);
                console.log(resp);
                this.buildings.push(resp);
                this.buildingMetaData = resp.data;
            }
        },
        created: async function () {
            this.vendingContract = new ethers.Contract(
                this.vendingAddress,
                this.vendingAbi,
                signer
            );

            this.blockcitiesContract = new ethers.Contract(
                this.blockcitiesAddress,
                this.blockcitiesAbi,
                signer
            );

            this.pricePerBuildingInWei = (await this.vendingContract.totalPrice(1));
            this.totalBuildings = (await this.blockcitiesContract.totalBuildings()).toNumber();

            const allBuildings = [];
            for (let i = 1; i <= this.totalBuildings; i++) {
                console.log(i);
                allBuildings.push(axios.get(`${this.rootApi}/network/${networkId}/token/${i}`));
            }

            this.buildings = await Promise.all(allBuildings);
        }
    });
</script>

</body>

</html>
