<html>

<head>
    <title>BlockCities</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet"
          href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
          crossorigin="anonymous">
</head>

<body>

<div id="vue-app" class="container">
    <div class="jumbotron mt-5">
        <h1 class="display-4">BlockCities Vending Machine</h1>
        <p class="lead">Be the Architect</p>
        <hr class="my-4">
        <div class="row">
            <div class="col">
                <p class="lead">
                    Price per building: {{ pricePerBuildingInWei }} WEI<br/>
                    <a class="btn btn-primary btn-lg" href="#" role="button" @click="mintBuilding()">Mint building</a>
                </p>
            </div>
            <div class="col">
                <p class="lead">
                    Total buildings: {{ totalBuildings }}
                </p>
            </div>
        </div>
        <div class="row" v-if="buildingMetaData">
            <div class="col">
                <code>
                    {{ buildingMetaData}}
                </code>
            </div>
            <div class="col text-center">
                <img :src="buildingMetaData.image" class="img-fluid"/>
            </div>
        </div>
    </div>

    <div class="card-columns">
        <div class="card m-2 p-2" v-if="buildings" v-for="b in buildings">
            <img class="card-img-top" :src="b.data.image" :alt="b.data.name" style="max-height: 250px">
            <div class="card-body">
                <h3 class="card-title text-center">{{ b.data.name }}</h3>
                <p class="small"><span class="text-muted">Architect</span> <code>{{ b.data.architect }}</code></p>
            </div>
        </div>
    </div>
</div>

<script src="https://use.fontawesome.com/e88a1894a6.js" type="text/javascript"></script>

<!-- This exposes the library as a global variable: ethers -->
<script src="https://cdn.ethers.io/scripts/ethers-v4.min.js"
        charset="utf-8"
        type="text/javascript">
</script>

<script src="https://unpkg.com/vue/dist/vue.js" type="text/javascript"></script>
<script src="https://unpkg.com/vue-toasted"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>


<script>
    /* global Vue, ethers, Toasted, axios */
    Vue.use(Toasted);

    // var provider = new ethers.providers.InfuraProvider('ropsten');
    // const provider = new ethers.providers.JsonRpcProvider('http://127.0.0.1:7545');
    const provider = new ethers.providers.Web3Provider(web3.currentProvider);
    const signer = provider.getSigner();
    const networkId = 3;

    new Vue({
        el: '#vue-app',
        data: {
            rootApi: (networkId === 5777) ? `http://localhost:5000/block-cities/us-central1/api` : `https://us-central1-block-cities.cloudfunctions.net/api`,
            blockcitiesAddress: (networkId === 5777) ? `0x194bAfbf8eb2096e63C5d9296363d6DAcdb32527` : `0xa5da44032B0e1A12F0BE6046Ff1aAF4837Ef83f7`,
            blockcitiesAbi: [
                {
                    'constant': true,
                    'inputs': [
                        {
                            'name': 'interfaceId',
                            'type': 'bytes4'
                        }
                    ],
                    'name': 'supportsInterface',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'bool'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'view',
                    'type': 'function',
                    'signature': '0x01ffc9a7'
                },
                {
                    'constant': true,
                    'inputs': [],
                    'name': 'name',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'string'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'view',
                    'type': 'function',
                    'signature': '0x06fdde03'
                },
                {
                    'constant': true,
                    'inputs': [
                        {
                            'name': 'tokenId',
                            'type': 'uint256'
                        }
                    ],
                    'name': 'getApproved',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'address'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'view',
                    'type': 'function',
                    'signature': '0x081812fc'
                },
                {
                    'constant': false,
                    'inputs': [
                        {
                            'name': 'to',
                            'type': 'address'
                        },
                        {
                            'name': 'tokenId',
                            'type': 'uint256'
                        }
                    ],
                    'name': 'approve',
                    'outputs': [],
                    'payable': false,
                    'stateMutability': 'nonpayable',
                    'type': 'function',
                    'signature': '0x095ea7b3'
                },
                {
                    'constant': false,
                    'inputs': [
                        {
                            'name': 'account',
                            'type': 'address'
                        }
                    ],
                    'name': 'addWhitelisted',
                    'outputs': [],
                    'payable': false,
                    'stateMutability': 'nonpayable',
                    'type': 'function',
                    'signature': '0x10154bad'
                },
                {
                    'constant': true,
                    'inputs': [],
                    'name': 'totalSupply',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'uint256'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'view',
                    'type': 'function',
                    'signature': '0x18160ddd'
                },
                {
                    'constant': true,
                    'inputs': [],
                    'name': 'cityPointer',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'uint256'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'view',
                    'type': 'function',
                    'signature': '0x20071a12'
                },
                {
                    'constant': false,
                    'inputs': [
                        {
                            'name': 'from',
                            'type': 'address'
                        },
                        {
                            'name': 'to',
                            'type': 'address'
                        },
                        {
                            'name': 'tokenId',
                            'type': 'uint256'
                        }
                    ],
                    'name': 'transferFrom',
                    'outputs': [],
                    'payable': false,
                    'stateMutability': 'nonpayable',
                    'type': 'function',
                    'signature': '0x23b872dd'
                },
                {
                    'constant': false,
                    'inputs': [
                        {
                            'name': 'account',
                            'type': 'address'
                        }
                    ],
                    'name': 'removeWhitelisted',
                    'outputs': [],
                    'payable': false,
                    'stateMutability': 'nonpayable',
                    'type': 'function',
                    'signature': '0x291d9549'
                },
                {
                    'constant': true,
                    'inputs': [
                        {
                            'name': 'owner',
                            'type': 'address'
                        },
                        {
                            'name': 'index',
                            'type': 'uint256'
                        }
                    ],
                    'name': 'tokenOfOwnerByIndex',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'uint256'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'view',
                    'type': 'function',
                    'signature': '0x2f745c59'
                },
                {
                    'constant': true,
                    'inputs': [
                        {
                            'name': 'account',
                            'type': 'address'
                        }
                    ],
                    'name': 'isWhitelisted',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'bool'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'view',
                    'type': 'function',
                    'signature': '0x3af32abf'
                },
                {
                    'constant': true,
                    'inputs': [],
                    'name': 'tokenIdPointer',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'uint256'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'view',
                    'type': 'function',
                    'signature': '0x3b3a1a7a'
                },
                {
                    'constant': true,
                    'inputs': [],
                    'name': 'totalBuildings',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'uint256'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'view',
                    'type': 'function',
                    'signature': '0x3ba5c722'
                },
                {
                    'constant': false,
                    'inputs': [
                        {
                            'name': 'from',
                            'type': 'address'
                        },
                        {
                            'name': 'to',
                            'type': 'address'
                        },
                        {
                            'name': 'tokenId',
                            'type': 'uint256'
                        }
                    ],
                    'name': 'safeTransferFrom',
                    'outputs': [],
                    'payable': false,
                    'stateMutability': 'nonpayable',
                    'type': 'function',
                    'signature': '0x42842e0e'
                },
                {
                    'constant': false,
                    'inputs': [],
                    'name': 'renounceWhitelistAdmin',
                    'outputs': [],
                    'payable': false,
                    'stateMutability': 'nonpayable',
                    'type': 'function',
                    'signature': '0x4c5a628c'
                },
                {
                    'constant': true,
                    'inputs': [],
                    'name': 'tokenBaseURI',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'string'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'view',
                    'type': 'function',
                    'signature': '0x4e99b800'
                },
                {
                    'constant': true,
                    'inputs': [
                        {
                            'name': 'index',
                            'type': 'uint256'
                        }
                    ],
                    'name': 'tokenByIndex',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'uint256'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'view',
                    'type': 'function',
                    'signature': '0x4f6ccce7'
                },
                {
                    'constant': true,
                    'inputs': [
                        {
                            'name': 'tokenId',
                            'type': 'uint256'
                        }
                    ],
                    'name': 'ownerOf',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'address'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'view',
                    'type': 'function',
                    'signature': '0x6352211e'
                },
                {
                    'constant': true,
                    'inputs': [
                        {
                            'name': '',
                            'type': 'uint256'
                        }
                    ],
                    'name': 'cities',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'bytes32'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'view',
                    'type': 'function',
                    'signature': '0x6a51b918'
                },
                {
                    'constant': true,
                    'inputs': [
                        {
                            'name': 'owner',
                            'type': 'address'
                        }
                    ],
                    'name': 'balanceOf',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'uint256'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'view',
                    'type': 'function',
                    'signature': '0x70a08231'
                },
                {
                    'constant': false,
                    'inputs': [
                        {
                            'name': 'account',
                            'type': 'address'
                        }
                    ],
                    'name': 'addWhitelistAdmin',
                    'outputs': [],
                    'payable': false,
                    'stateMutability': 'nonpayable',
                    'type': 'function',
                    'signature': '0x7362d9c8'
                },
                {
                    'constant': true,
                    'inputs': [],
                    'name': 'symbol',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'string'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'view',
                    'type': 'function',
                    'signature': '0x95d89b41'
                },
                {
                    'constant': false,
                    'inputs': [
                        {
                            'name': 'to',
                            'type': 'address'
                        },
                        {
                            'name': 'approved',
                            'type': 'bool'
                        }
                    ],
                    'name': 'setApprovalForAll',
                    'outputs': [],
                    'payable': false,
                    'stateMutability': 'nonpayable',
                    'type': 'function',
                    'signature': '0xa22cb465'
                },
                {
                    'constant': false,
                    'inputs': [
                        {
                            'name': 'from',
                            'type': 'address'
                        },
                        {
                            'name': 'to',
                            'type': 'address'
                        },
                        {
                            'name': 'tokenId',
                            'type': 'uint256'
                        },
                        {
                            'name': '_data',
                            'type': 'bytes'
                        }
                    ],
                    'name': 'safeTransferFrom',
                    'outputs': [],
                    'payable': false,
                    'stateMutability': 'nonpayable',
                    'type': 'function',
                    'signature': '0xb88d4fde'
                },
                {
                    'constant': true,
                    'inputs': [
                        {
                            'name': 'account',
                            'type': 'address'
                        }
                    ],
                    'name': 'isWhitelistAdmin',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'bool'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'view',
                    'type': 'function',
                    'signature': '0xbb5f747b'
                },
                {
                    'constant': true,
                    'inputs': [
                        {
                            'name': 'tokenId',
                            'type': 'uint256'
                        }
                    ],
                    'name': 'tokenURI',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'string'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'view',
                    'type': 'function',
                    'signature': '0xc87b56dd'
                },
                {
                    'constant': false,
                    'inputs': [],
                    'name': 'renounceWhitelisted',
                    'outputs': [],
                    'payable': false,
                    'stateMutability': 'nonpayable',
                    'type': 'function',
                    'signature': '0xd6cd9473'
                },
                {
                    'constant': true,
                    'inputs': [
                        {
                            'name': 'owner',
                            'type': 'address'
                        },
                        {
                            'name': 'operator',
                            'type': 'address'
                        }
                    ],
                    'name': 'isApprovedForAll',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'bool'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'view',
                    'type': 'function',
                    'signature': '0xe985e9c5'
                },
                {
                    'inputs': [
                        {
                            'name': '_tokenBaseURI',
                            'type': 'string'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'nonpayable',
                    'type': 'constructor',
                    'signature': 'constructor'
                },
                {
                    'anonymous': false,
                    'inputs': [
                        {
                            'indexed': true,
                            'name': '_tokenId',
                            'type': 'uint256'
                        },
                        {
                            'indexed': true,
                            'name': '_to',
                            'type': 'address'
                        },
                        {
                            'indexed': true,
                            'name': '_architect',
                            'type': 'address'
                        }
                    ],
                    'name': 'BuildingMinted',
                    'type': 'event',
                    'signature': '0x90ac329ea07c00bb85a3b33470a0318e5d1a5e181fd50431248bc3c750695277'
                },
                {
                    'anonymous': false,
                    'inputs': [
                        {
                            'indexed': true,
                            'name': '_cityId',
                            'type': 'uint256'
                        },
                        {
                            'indexed': false,
                            'name': '_cityName',
                            'type': 'bytes32'
                        }
                    ],
                    'name': 'CityAdded',
                    'type': 'event',
                    'signature': '0xa2e4e22d1e9b0b4d3847dc1b106906a4ce32e6636b6169a9733c7f70949bbbe7'
                },
                {
                    'anonymous': false,
                    'inputs': [
                        {
                            'indexed': true,
                            'name': 'account',
                            'type': 'address'
                        }
                    ],
                    'name': 'WhitelistedAdded',
                    'type': 'event',
                    'signature': '0xee1504a83b6d4a361f4c1dc78ab59bfa30d6a3b6612c403e86bb01ef2984295f'
                },
                {
                    'anonymous': false,
                    'inputs': [
                        {
                            'indexed': true,
                            'name': 'account',
                            'type': 'address'
                        }
                    ],
                    'name': 'WhitelistedRemoved',
                    'type': 'event',
                    'signature': '0x270d9b30cf5b0793bbfd54c9d5b94aeb49462b8148399000265144a8722da6b6'
                },
                {
                    'anonymous': false,
                    'inputs': [
                        {
                            'indexed': true,
                            'name': 'account',
                            'type': 'address'
                        }
                    ],
                    'name': 'WhitelistAdminAdded',
                    'type': 'event',
                    'signature': '0x22380c05984257a1cb900161c713dd71d39e74820f1aea43bd3f1bdd20961299'
                },
                {
                    'anonymous': false,
                    'inputs': [
                        {
                            'indexed': true,
                            'name': 'account',
                            'type': 'address'
                        }
                    ],
                    'name': 'WhitelistAdminRemoved',
                    'type': 'event',
                    'signature': '0x0a8eb35e5ca14b3d6f28e4abf2f128dbab231a58b56e89beb5d636115001e165'
                },
                {
                    'anonymous': false,
                    'inputs': [
                        {
                            'indexed': true,
                            'name': 'from',
                            'type': 'address'
                        },
                        {
                            'indexed': true,
                            'name': 'to',
                            'type': 'address'
                        },
                        {
                            'indexed': true,
                            'name': 'tokenId',
                            'type': 'uint256'
                        }
                    ],
                    'name': 'Transfer',
                    'type': 'event',
                    'signature': '0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef'
                },
                {
                    'anonymous': false,
                    'inputs': [
                        {
                            'indexed': true,
                            'name': 'owner',
                            'type': 'address'
                        },
                        {
                            'indexed': true,
                            'name': 'approved',
                            'type': 'address'
                        },
                        {
                            'indexed': true,
                            'name': 'tokenId',
                            'type': 'uint256'
                        }
                    ],
                    'name': 'Approval',
                    'type': 'event',
                    'signature': '0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925'
                },
                {
                    'anonymous': false,
                    'inputs': [
                        {
                            'indexed': true,
                            'name': 'owner',
                            'type': 'address'
                        },
                        {
                            'indexed': true,
                            'name': 'operator',
                            'type': 'address'
                        },
                        {
                            'indexed': false,
                            'name': 'approved',
                            'type': 'bool'
                        }
                    ],
                    'name': 'ApprovalForAll',
                    'type': 'event',
                    'signature': '0x17307eab39ab6107e8899845ad3d59bd9653f200f220920489ca2b5937696c31'
                },
                {
                    'constant': false,
                    'inputs': [
                        {
                            'name': '_exteriorColorway',
                            'type': 'uint256'
                        },
                        {
                            'name': '_windowColorway',
                            'type': 'uint256'
                        },
                        {
                            'name': '_city',
                            'type': 'uint256'
                        },
                        {
                            'name': '_base',
                            'type': 'uint256'
                        },
                        {
                            'name': '_body',
                            'type': 'uint256'
                        },
                        {
                            'name': '_roof',
                            'type': 'uint256'
                        },
                        {
                            'name': '_architect',
                            'type': 'address'
                        }
                    ],
                    'name': 'createBuilding',
                    'outputs': [
                        {
                            'name': '_tokenId',
                            'type': 'uint256'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'nonpayable',
                    'type': 'function',
                    'signature': '0xa0168aa2'
                },
                {
                    'constant': true,
                    'inputs': [
                        {
                            'name': '_tokenId',
                            'type': 'uint256'
                        }
                    ],
                    'name': 'attributes',
                    'outputs': [
                        {
                            'name': '_exteriorColorway',
                            'type': 'uint256'
                        },
                        {
                            'name': '_windowColorway',
                            'type': 'uint256'
                        },
                        {
                            'name': '_city',
                            'type': 'uint256'
                        },
                        {
                            'name': '_base',
                            'type': 'uint256'
                        },
                        {
                            'name': '_body',
                            'type': 'uint256'
                        },
                        {
                            'name': '_roof',
                            'type': 'uint256'
                        },
                        {
                            'name': '_architect',
                            'type': 'address'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'view',
                    'type': 'function',
                    'signature': '0xd05dcc6a'
                },
                {
                    'constant': true,
                    'inputs': [
                        {
                            'name': 'owner',
                            'type': 'address'
                        }
                    ],
                    'name': 'tokensOfOwner',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'uint256[]'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'view',
                    'type': 'function',
                    'signature': '0x8462151c'
                },
                {
                    'constant': true,
                    'inputs': [],
                    'name': 'totalCities',
                    'outputs': [
                        {
                            'name': '_total',
                            'type': 'uint256'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'view',
                    'type': 'function',
                    'signature': '0xf09bea14'
                },
                {
                    'constant': false,
                    'inputs': [
                        {
                            'name': '_cityName',
                            'type': 'bytes32'
                        }
                    ],
                    'name': 'addCity',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'bool'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'nonpayable',
                    'type': 'function',
                    'signature': '0x567629ce'
                },
                {
                    'constant': false,
                    'inputs': [
                        {
                            'name': '_tokenId',
                            'type': 'uint256'
                        }
                    ],
                    'name': 'burn',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'bool'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'nonpayable',
                    'type': 'function',
                    'signature': '0x42966c68'
                },
                {
                    'constant': false,
                    'inputs': [
                        {
                            'name': '_tokenId',
                            'type': 'uint256'
                        },
                        {
                            'name': '_tokenUri',
                            'type': 'string'
                        }
                    ],
                    'name': 'setTokenURI',
                    'outputs': [],
                    'payable': false,
                    'stateMutability': 'nonpayable',
                    'type': 'function',
                    'signature': '0x162094c4'
                },
                {
                    'constant': false,
                    'inputs': [
                        {
                            'name': '_newBaseURI',
                            'type': 'string'
                        }
                    ],
                    'name': 'updateTokenBaseURI',
                    'outputs': [],
                    'payable': false,
                    'stateMutability': 'nonpayable',
                    'type': 'function',
                    'signature': '0x2295ee5b'
                }
            ],
            blockcitiesContract: null,
            vendingAddress: (networkId === 5777) ? `0x4A952a0e80A7549f6A8aa4A08d1d23E840A44fC1` : `0x2AF29aa150Ee61f08356859Ef46CA7F6B3084089`,
            vendingAbi: [
                {
                    'constant': true,
                    'inputs': [],
                    'name': 'cityGenerator',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'address'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'view',
                    'type': 'function',
                    'signature': '0x07fa1dc9'
                },
                {
                    'constant': true,
                    'inputs': [],
                    'name': 'blockCities',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'address'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'view',
                    'type': 'function',
                    'signature': '0x0bd3b6fd'
                },
                {
                    'constant': false,
                    'inputs': [
                        {
                            'name': '_techPartnerRate',
                            'type': 'uint256'
                        }
                    ],
                    'name': 'updateTechPartnerRate',
                    'outputs': [],
                    'payable': false,
                    'stateMutability': 'nonpayable',
                    'type': 'function',
                    'signature': '0x22e836b6'
                },
                {
                    'constant': true,
                    'inputs': [],
                    'name': 'techPartner',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'address'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'view',
                    'type': 'function',
                    'signature': '0x2700c875'
                },
                {
                    'constant': false,
                    'inputs': [
                        {
                            'name': '_blockCities',
                            'type': 'address'
                        }
                    ],
                    'name': 'updateBlockCitiesAddress',
                    'outputs': [],
                    'payable': false,
                    'stateMutability': 'nonpayable',
                    'type': 'function',
                    'signature': '0x3ee71ffc'
                },
                {
                    'constant': true,
                    'inputs': [],
                    'name': 'baseGenerator',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'address'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'view',
                    'type': 'function',
                    'signature': '0x5098cd99'
                },
                {
                    'constant': true,
                    'inputs': [],
                    'name': 'bodyGenerator',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'address'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'view',
                    'type': 'function',
                    'signature': '0x57d47e30'
                },
                {
                    'constant': true,
                    'inputs': [],
                    'name': 'roofGenerator',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'address'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'view',
                    'type': 'function',
                    'signature': '0x5bdb51ac'
                },
                {
                    'constant': true,
                    'inputs': [],
                    'name': 'totalPurchasesInWei',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'uint256'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'view',
                    'type': 'function',
                    'signature': '0x5f1e98c7'
                },
                {
                    'constant': false,
                    'inputs': [],
                    'name': 'renounceOwnership',
                    'outputs': [],
                    'payable': false,
                    'stateMutability': 'nonpayable',
                    'type': 'function',
                    'signature': '0x715018a6'
                },
                {
                    'constant': true,
                    'inputs': [],
                    'name': 'owner',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'address'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'view',
                    'type': 'function',
                    'signature': '0x8da5cb5b'
                },
                {
                    'constant': true,
                    'inputs': [],
                    'name': 'isOwner',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'bool'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'view',
                    'type': 'function',
                    'signature': '0x8f32d59b'
                },
                {
                    'constant': true,
                    'inputs': [],
                    'name': 'pricePerBuildingInWei',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'uint256'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'view',
                    'type': 'function',
                    'signature': '0xb29f3e48'
                },
                {
                    'constant': true,
                    'inputs': [],
                    'name': 'techPartnerRate',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'uint256'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'view',
                    'type': 'function',
                    'signature': '0xb2c80876'
                },
                {
                    'constant': false,
                    'inputs': [
                        {
                            'name': '_techPartner',
                            'type': 'address'
                        }
                    ],
                    'name': 'updateTechPartnerAddress',
                    'outputs': [],
                    'payable': false,
                    'stateMutability': 'nonpayable',
                    'type': 'function',
                    'signature': '0xeddfb745'
                },
                {
                    'constant': false,
                    'inputs': [
                        {
                            'name': 'newOwner',
                            'type': 'address'
                        }
                    ],
                    'name': 'transferOwnership',
                    'outputs': [],
                    'payable': false,
                    'stateMutability': 'nonpayable',
                    'type': 'function',
                    'signature': '0xf2fde38b'
                },
                {
                    'constant': true,
                    'inputs': [
                        {
                            'name': '',
                            'type': 'address'
                        }
                    ],
                    'name': 'credits',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'uint256'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'view',
                    'type': 'function',
                    'signature': '0xfe5ff468'
                },
                {
                    'inputs': [
                        {
                            'name': '_cityGenerator',
                            'type': 'address'
                        },
                        {
                            'name': '_baseGenerator',
                            'type': 'address'
                        },
                        {
                            'name': '_bodyGenerator',
                            'type': 'address'
                        },
                        {
                            'name': '_roofGenerator',
                            'type': 'address'
                        },
                        {
                            'name': '_blockCities',
                            'type': 'address'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'nonpayable',
                    'type': 'constructor',
                    'signature': 'constructor'
                },
                {
                    'anonymous': false,
                    'inputs': [
                        {
                            'indexed': false,
                            'name': '_oldPricePerBuildingInWei',
                            'type': 'uint256'
                        },
                        {
                            'indexed': false,
                            'name': '_newPricePerBuildingInWei',
                            'type': 'uint256'
                        }
                    ],
                    'name': 'PricePerBuildingInWeiChanged',
                    'type': 'event',
                    'signature': '0x6eb4d51aa48070ba41a35eb953c66c728b4c501b8f861193e18c39999f0e1213'
                },
                {
                    'anonymous': false,
                    'inputs': [
                        {
                            'indexed': true,
                            'name': '_tokenId',
                            'type': 'uint256'
                        },
                        {
                            'indexed': true,
                            'name': '_architect',
                            'type': 'address'
                        }
                    ],
                    'name': 'VendingMachineTriggered',
                    'type': 'event',
                    'signature': '0x372a2d4d08206e1dfd3c166a68a3079282f2d28d305b51a31446b04522032538'
                },
                {
                    'anonymous': false,
                    'inputs': [
                        {
                            'indexed': true,
                            'name': '_to',
                            'type': 'address'
                        }
                    ],
                    'name': 'CreditAdded',
                    'type': 'event',
                    'signature': '0x8466168d4947c73f9fa41c3bc9a6e5efc442f28ec139dbfdbdc1ead3ab885389'
                },
                {
                    'anonymous': false,
                    'inputs': [
                        {
                            'indexed': true,
                            'name': 'previousOwner',
                            'type': 'address'
                        },
                        {
                            'indexed': true,
                            'name': 'newOwner',
                            'type': 'address'
                        }
                    ],
                    'name': 'OwnershipTransferred',
                    'type': 'event',
                    'signature': '0x8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e0'
                },
                {
                    'constant': false,
                    'inputs': [],
                    'name': 'mintBuilding',
                    'outputs': [
                        {
                            'name': '_tokenId',
                            'type': 'uint256'
                        }
                    ],
                    'payable': true,
                    'stateMutability': 'payable',
                    'type': 'function',
                    'signature': '0x6070e053'
                },
                {
                    'constant': false,
                    'inputs': [
                        {
                            'name': '_newPricePerBuildingInWei',
                            'type': 'uint256'
                        }
                    ],
                    'name': 'setPricePerBuildingInWei',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'bool'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'nonpayable',
                    'type': 'function',
                    'signature': '0x9fc1185e'
                },
                {
                    'constant': false,
                    'inputs': [
                        {
                            'name': '_to',
                            'type': 'address'
                        }
                    ],
                    'name': 'addCredit',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'bool'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'nonpayable',
                    'type': 'function',
                    'signature': '0x7c334d0b'
                },
                {
                    'constant': false,
                    'inputs': [
                        {
                            'name': '_addresses',
                            'type': 'address[]'
                        }
                    ],
                    'name': 'addCreditBatch',
                    'outputs': [
                        {
                            'name': '',
                            'type': 'bool'
                        }
                    ],
                    'payable': false,
                    'stateMutability': 'nonpayable',
                    'type': 'function',
                    'signature': '0x8a105d3f'
                }
            ],
            vendingContract: null,
            pricePerBuildingInWei: null,
            totalBuildings: 0,
            buildingTokenId: null,
            buildingMetaData: null,
            buildings: [],
        },
        methods: {
            mintBuilding: async function () {
                let overrides = {

                    // The maximum units of gas for the transaction to use
                    gasLimit: 6721975,

                    // The price (in wei) per unit of gas
                    gasPrice: 1000000000,

                    // The amount to send with the transaction (i.e. msg.value)
                    value: this.pricePerBuildingInWei,
                };

                // wait for tx to be mined
                let tx = await this.vendingContract.mintBuilding(overrides);
                let receipt = await tx.wait(1);
                const tokenIdBN = receipt.events.pop().args[0];
                this.buildingTokenId = tokenIdBN.toNumber();
                console.log(`Token ID:`, this.buildingTokenId);

                this.$toasted.show(`Building created: ${this.buildingTokenId}`, {
                    theme: 'bubble',
                    position: 'bottom-center',
                    duration: 5000
                });

                // refresh total
                this.totalBuildings = (await this.blockcitiesContract.totalBuildings()).toNumber();

                let resp = await axios.get(`${this.rootApi}/network/${networkId}/token/${this.buildingTokenId}/details`);
                this.buildings.push(resp);
                this.buildingMetaData = resp.data;
            }
        },
        created: async function () {
            this.vendingContract = new ethers.Contract(
                this.vendingAddress,
                this.vendingAbi,
                signer
            );

            this.blockcitiesContract = new ethers.Contract(
                this.blockcitiesAddress,
                this.blockcitiesAbi,
                signer
            );

            this.pricePerBuildingInWei = (await this.vendingContract.pricePerBuildingInWei()).toNumber();
            this.totalBuildings = (await this.blockcitiesContract.totalBuildings()).toNumber();

            const allBuildings = [];
            for (let i = 1; i < (this.totalBuildings + 1); i++) {
                allBuildings.push(axios.get(`${this.rootApi}/network/${networkId}/token/${i}/details`));
            }

            this.buildings = await Promise.all(allBuildings);
        }
    });
</script>

</body>

</html>